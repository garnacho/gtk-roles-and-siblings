2008-12-26  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtkentry.c: Emit property notification for the text-length
	property.

2008-12-26  Matthias Clasen  <mclasen@redhat.com>

	* demos/gtk-demo/search_entry.c: Add a demo for new entry features.
	* demos/gtk-demo/Makefile.am: Glue

2008-12-25  Matthias Clasen  <mclasen@redhat.com>

	* gdk/gdkapplaunchcontext.c:
	* gdk/gdkkeys.c:
	* gdk/x11/gdkdnd-x11.c:
	* gdk/x11/gdkkeyx-x11.c:
	* gdk/x11/gdktestutils-x11.c: Typo fixes and other small
	doc improvements.

2008-12-23  Li Yuan  <li.yuan@sun.com>

	* gtk/gtkiconview.c: (gtk_icon_view_accessible_model_row_changed):
	Bug #549251. No need to set name if there is no a11y item object.

2008-12-21  Yair Hershkovitz  <yairhr@gmail.com>

	Bug 565203: RTL locales: icons are misplaced when horizontal 
	            gtkiconview is contained in a gtkscrolledwindow.

	* gtk/gtkiconview.c (gtk_icon_view_layout_single_row):
	Fix horizontal icon positions when in RTL locale.

2008-12-19  Matthias Clasen  <mclasen@redhat.com>

	* NEWS: Update

2008-12-19  Matthias Clasen  <mclasen@redhat.com>

	Bug 564881 – gtkstatusicon.c: 'event' bug again

	* gtk/gtkstatusicon.c (button_callback): Fix the build.
	Patch by Christian Dywan.

2008-12-19  Cody Russell  <bratsche@gnome.org>

	Bug 85292 – add an icon to gtkentry

	* gtk/gtkmarshalers.list: Add VOID:INT,BOXED
	* tests/testentryicons.c: Initial icon entry test
	* tests/Makefile.am: Add testentryicons
	* gtk/gtkentry.[ch]: Add API for setting primary/secondary icons
	and other features related to them.
	
2008-12-19  Marek Kasik  <mkasik@redhat.com>

	Bug 339318 - Allow page rendering to (optionally) happen in a thread

	* gtk/gtk.symbols: API change
	* doc/reference/gtk/gtk-sections.txt: API change
	* gtk/gtkprintoperation-private.h
	* gtk/gtkprintoperation.h
	* gtk/gtkprintoperation.c: Adds 2 new functions
	   gtk_print_operation_set_defer_drawing()
	     - Sets up the GtkPrintOperation to wait for calling of
	       gtk_print_operation_draw_page_finish() from application. It can
	       be used for drawing page in another thread.
	       This function must be called in the callback of "draw-page"
	       signal.
	   gtk_print_operation_draw_page_finish()
	     - Signalize that drawing of particular page is complete.
	       It is called after completion of page drawing (e.g. drawing
	       in another thread).
	       If gtk_print_operation_set_defer_drawing() was called before,
	       then this function has to be called by application. In another
	       case it is called by the library itself.

2008-12-15  Matthias Clasen  <mclasen@redhat.com>

        * gtk/gtkprintunixdialog.c: Don't export emit_ok_response

2008-12-15  Tomas Bzatek  <tbzatek@redhat.com>

	* gtk/gtkfilechooserdefault.c: (list_row_activated):
	* gtk/gtkfilesystem.c: (_gtk_file_info_consider_as_directory):
	Mask G_FILE_TYPE_SHORTCUT as a directory (#561494)

2008-12-13  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtkfilechooserdefault.c (update_current_folder_get_info_cb):
	Mount the enclosing volume if the folder we're switching to is not
	mounted. Patch by Tomas Bzatek, based on work by Carlos Garnacho

2008-12-13  Matthias Clasen  <mclasen@redhat.com>

	Bug 561494 – FileChooser network browsing and authentication support

	* gtk/gtkfilesystem.[hc] (_gtk_file_info_consider_as_directory): 
	Privately export this method. It classifies directories and mountables
	the same.

	* gtk/gtkfilesystem.c (enclosing_volume_mount_cb): Silently drop
	G_IO_ERROR_ALREADY_MOUNTED error for gvfs backends without visible
	mounts.

	* gtk/gtkfilesystemmodel.c:
	* gtk/gtkfilechooserbutton.c:
	* gtk/gtkfilechooserentry.c: 
	* gtk/gtkfilechooserdefault.c: Use the new function instead of 
	direct checks for G_FILE_TYPE_DIRECTORY throughout.

2008-12-13  Matthias Clasen  <mclasen@redhat.com>
	
	Bug 562579 – Remove error dialog when directory does not exist

	* gtk/gtkfilechooserdefault.c (update_current_folder_get_info_cb):
	Don't show an error dialog when changing to a non-existing folder,
	since this is ususally just an annoyance. 

2008-12-13  Matthias Clasen  <mclasen@redhat.com>

	Bug 556233 – local-only causes G_IS_FILE warning

	* gtk/gktfilechooserdefault.c (set_local_only): Avoid a warning
	in tests. Patch by Christian Dywan

2008-12-13  Matthias Clasen  <mclasen@redhat.com>

	Bug 563158 – CellRendererProgress pulsing and progressing rows can 
	not be used together

	* gtk/gtkcellrendererprogress.c (gtk_cell_renderer_progress_set_pulse):
	Don't try to keep state in a cell renderer between two paint
	calls. It doesn't work. Patch by Kristian Mueller

2008-12-13  Matthias Clasen  <mclasen@redhat.com>

	Bug 555560 – gtk_combo_box_set_active fails with no model
	
	* gtk/gtkcombobox.c: Allow out-of-order setting of model and active.
	Patch by Christian Dywan

2008-12-13  Matthias Clasen  <mclasen@redhat.com>

	Bug 558306 – Cannot build gdk (gtk+ 2.14.4) on Solaris 8

	* gdk/x11/gdktestutils-x11.c (gdk_test_simulate_button):
	Remove a C99ism. Pointed out by Eric Lamarque

2008-12-13  Matthias Clasen  <mclasen@redhat.com>

	Bug 549251 – GTK icon view accessible issue.

	* gtk/gtkiconview.c (gtk_icon_view_accessible_model_row_changed):
	Handle separate append/set for rows.  Patch by Li Yuan

2008-12-13  Matthias Clasen  <mclasen@redhat.com>

	Bug 556839 – Crash when opening a link

	* gtk/gtkstatusicon.c (gtk_status_icon_finalize): Destroy the
	image too. Patch by Carlos Garcia Campos

2008-12-13  Matthias Clasen  <mclasen@redhat.com>

	Bug 563751 – xatom cache is prefilled too late

	* gdk/x11/gdkdisplay-x11.c (gdk_display_open): Initialize the
	XAtom cache earlier. Patch by Christian Persch

2008-12-13  Matthias Clasen  <mclasen@redhat.com>

	Bug 564212 – gtk_icon_view_accessible_model_rows_reordered explain 
	new_order in the wrong way

	* gtk/gtkiconview.c (gtk_icon_view_accessible_model_rows_reordered):
	Use the new order correctly.  Patch by Li Yuan

2008-12-13  Matthias Clasen  <mclasen@redhat.com>

	Bug 563835 – Typo in gtk_widget_has_screen() docs

	* gdk/directfb/gdkwindow-directfb.c:
	* gdk/gdkwindow.c:
	* gdk/x11/gdkwindow-x11.c:
	* gtk/gtkmenushell.c:
	* gtk/gtkwidget.c:
	* gtk/tests/builder.c:
	* tests/testdnd.c: s/heirarchy/hierarchy/ in docs and comments.
	Pointed out by Wouter Bolsterlee

2008-12-12  Matthias Clasen  <mclasen@redhat.com>

	Bug 564066 – Crash in gtk_rc_parse_default_files

	* gtk/gtkrc.c (gtk_rc_parse_default_files): Handle being called
	early. Bug report by Andrés G. Aragoneses

2008-12-12  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtkmountoperation.c: Set an empty title on password dialogs.
	Pointed out by Máirín Duffy.

2008-12-11  Sven Herzberg  <sven@imendio.com>

	Document the "set-scroll-adjustments" signal

	Reviewed by Kristian Rietveld.

	* gtk/gtkiconview.c,
	* gtk/gtklayout.c,
	* gtk/gtktextview.c,
	* gtk/gtktreeview.c,
	* gtk/gtkviewport.c: added proper documentation for the signal

2008-12-11  Daniel Elstner  <danielk@openismus.com>

	Bug 563994 – Input method module interface not documented

	* gtk/gtkimcontext.h: Add public/private markers.
	* gtk/gtkimcontext.c: Add section documentation which explains how
	to add a new input method module to GTK+.  Document the signals and
	virtual functions of GtkIMContextClass.
	* gtk/gtkimmodule.c: Document struct GtkIMContextInfo.
	* docs/reference/gtk/gtk-sections.txt: Add GtkIMContextClass and
	GtkIMContextInfo to section GtkIMContext.
	* docs/reference/gtk/Makefile.am (IGNORE_HFILES): Remove
	gtkimmodule.h from the list in order to pick up GtkIMContextInfo.
	* docs/reference/gtk/tmpl/gtkimcontext.sgml: Remove file from
	repository since all the hand-edited content has been migrated to
	source file comments.

2008-12-10  Matthias Clasen  <mclasen@redhat.com>

        Bug 563991 – gtk_file_chooser_button_new_with_backend is deprecated
        -- but what should be used instead?

        * gtk/gtkfilechooserbutton.c: Enhanced deprecation annotation.

2008-12-10  Daniel Elstner  <danielk@openismus.com>

	Maintenance of Multipress input method by Openismus GmbH:

	* modules/input/gtkimcontextmultipress.[ch]: Clean up the code
	a bit to follow the GTK+ coding style more closely.  Fix the code
	to emit "preedit-start" and "preedit-end", too, rather than only
	"preedit-changed".
	(GTK_IM_CONTEXT_MULTIPRESS*): Rename incorrectly spelled macros
	gtk_im_context_multipress*. Shouldn't break API or ABI as it's
	only used internally.
	* modules/input/immultipress.c: More cleanup,
	* modules/input/README.multipress: ditto.

2008-12-09  Michael Natterer  <mitch@imendio.com>

	* gdk/gdk.symbols: add missing #ifndef GDK_DISABLE_DEPRECATED.

2008-12-09  Michael Natterer  <mitch@imendio.com>

	* gtk/gtkcontainer.c (struct PackingPropertiesData): add missing
	semicolon.

	* gtk/gtkcontainer.c (attributes_text_element): "value" is a
	gchar*, not const gchar*.

2008-12-07  Matthias Clasen  <mclasen@redhat.com>

	Bug 546378 – GtkAssistant page title is not translatable

	* gtk/gtkbuilderparser.c: Make gtk_builder_get_translation_domain()
	useful for subparsers.

	* gtk/gtkcontainer.c: Make the child property parser support
	translatable child properties. Patch by Antti Kaijanmäki
 
2008-12-07  Matthias Clasen  <mclasen@redhat.com>

	Bug 554274 – Add default hook for GtkLinkButton

	* gtk/gtklinkbutton.c: Call gtk_show_uri() if no uri hook has
	been set. Patch by Emmanuele Bassi

2008-12-07  Matthias Clasen  <mclasen@redhat.com>

	Bug 559325 – documentation for gdk_display_get_window_at_pointer() 
:	is wrong

	* gdk/gdkdisplay.c (gdk_display_get_window_at_pointer): Correct
	the documentation. Patch by Paul Davis

2008-12-07  Matthias Clasen  <mclasen@redhat.com>

	Bug 563285 – test print backend does not compile

	* modules/printbackends/test/gtkprintbackendtest.c: Clean up
	includes. 

2008-12-07  Behdad Esfahbod  <behdad@gnome.org>

	Bug 563547 – Update gdkx11 atom precache table

	* gdk/x11/gdkdisplay-x11.c: Add more atoms to precache.

2008-12-05  Michael Natterer  <mitch@imendio.com>

	Bug 546285 – Allow GtkEntry to draw progress

	* gtk/gtkentry.[ch]: add new API similar to GtkProgressBar which
	allows to set the entry's progress_fraction, its progress_pulse_step
	and to let the entry's progress pulse.

	* gtk/gtk.symbols: updated.

	* tests/testgtk.c: add progress demo code to the "Entry" window.

2008-12-04  Johan Dahlin  <jdahlin@async.com.br>

	* gtk/gtkstatusicon.c:
	Add missing space in gtk-doc deprecated syntax

2008-12-03  Simos Xenitellis  <simos@gnome.org>

	Bug 557420 – Some compose sequences don't work anymore (or only in
	a specific order)

	* gtk/gtkimcontextsimple.c: Update of table size, keysym boundary,
	to match the gtkimcontextsimpleseqs.h table.
	* gtk/gtkimcontextsimpleseqs.h: Update with older gtk+ compose
	sequences that went missing due to table update with upstream.
	* gtk/compose-parse.py: Updated to include gtk-compose-lookaside.txt
	* gtk/gtk-compose-lookaside.txt: Older gtk+ compose sequences that
	are not found in the X.Org Compose file.

2008-12-03  Sven Herzberg  <sven@imendio.com>

	Bug 562998 – GtkFontButton documentation improvements

	* gtk/gtkfontbutton.c: mention the way the font string should be used.
	Patch by Sven Herzberg and Nelson Benitez

2008-12-03  Marek Kasik  <mkasik@redhat.com>

	Bug 559914 – eog doesn't apply paper setup.

	* gtk/gtkpapersize.c: Call the gtk_paper_size_new_from_ppd() with width
	and height in points.

2008-12-02  Carlos Garcia Campos  <carlosgc@gnome.org>

	Bug 562878 – password save incorrectly set in gtkmountoperation

	* gtk/gtkmountoperation.c (remember_button_toggled),
	(gtk_mount_operation_ask_password): Remember the password save
	flags only when the radio button becomes active. Set also the
	default state of the radio buttons depending on the current value
	of password save flags. 
	
2008-12-01  Matthias Clasen <mclasen@redhat.com>

	Bug 555334 – connected server feature

	* gtk/gtkfilesystem.c (get_volumes_list): Filter out shadow mounts.
	Patch by David Zeuthen.

2008-12-01  Matthias Clasen <mclasen@redhat.com>

	* gtk/gtkentry.c: Revert an accidental change that sneaked
	in with the last commit.

2008-12-01  Paul Bolle  <pebolle@tiscali.nl>

	Bug 562817 – GtkDialog: typo

	* gtk/gtkdialog.c: Fix typo

2008-11-29  Matthias Clasen  <mclasen@redhat.com>

	Bug 554453 – "typeahead find" widget of GtkTreeView appears on 
	wrong monitor in a multi-head environment

	* gtk/gtktreeview.c (gtk_tree_view_ensure_interactive_directory):
	Make sure the typeahead window follows screen changes of the
	treeview. Noticed by Rainer Stransky

2008-11-30  Christian Dywan  <christian@imendio.com>

	Bug 559622 – GdkDevice test segfaults

	* gdk/x11/gdkdisplay-x11.c (gdk_display_x11_dispose):
	* gdk/x11/gdkinput.c (gdk_device_class_init), (gdk_device_dispose):
	Free and reset device in dispose. Patch by Michael Natterer and myself.

2008-11-30  Christian Dywan  <christian@imendio.com>

	Bug 554076 – eventually release g_new-ed supported_atoms

	* gdk/x11/gdkevents-x11.c (cleanup_atoms),
	(gdk_x11_screen_supports_net_wm_hint): Set cleanup callback.
        Patch by Caolan McNamara.

2008-11-30  Christian Dywan  <christian@imendio.com>

	Bug 539263 – Deprecate gdk_window_get_toplevels

	* gdk/gdkwindow.c:
	* gdk/gdkwindow.h: Deprecate gdk_window_get_toplevels

2008-11-29  Federico Mena Quintero  <federico@novell.com>

	* gtk/gtktreeview.c (gtk_tree_view_bin_expose): If tree lines are
	enabled, flip them around for the right-to-left case.  Fixes
	https://bugzilla.novell.com/show_bug.cgi?id=447004.  Patch by
	Ricardo Cruz <rpmcruz@alunos.dcc.fc.up.pt>

2008-11-29  Christian Persch  <chpe@gnome.org>

	* gtk/gtkselection.c: Typo fix.

2008-11-29  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtkselection.c:
	* gtk/gtkentry.c:
	* gtk/gtkdnd.c:
	* gtk/gtkcolorsel.c:
	* gtk/gtkbindings.c: Improve deprecation annotations.

2008-11-26  Christian Dywan  <christian@imendio.com>

	Bug 561504 – testgtk should load rc file from sub folder

	* tests/testgtk.c (main):
        Make testgtk look in subfolder and warn if not found

2008-11-25  Johan Dahlin  <jdahlin@async.com.br>

	Bug 559947 – Unchecked dependency on python>=2.4

	* gtk/gtk-builder-convert:
	Avoid using sorted() which is only present in python 2.

2008-11-24  Tristan Van Berkom <tvb@gnome.org>

	* gtk/gtkalignment.c: Bug 561539 - Fix warnings when size allocations
	fall short of border width and padding.

2008-11-22  Paul Bolle  <pebolle@tiscali.nl>

	Bug 561335 - Fix typos in GtkToolItem documentation

	* gtk/gtktoolitem.c: Fix typos in GtkToolItem documentation

2008-11-21  Matthias Clasen <mclasen@redhat.com>

	* configure.in: Bump gtk-doc dependency to 1.11 for
	nicer index-generation.

2008-11-21  Matthias Clasen <mclasen@redhat.com>

	* gtk/gtkmountoperation.[hc]: Declare structs in a way that
	gtk-doc understands.

2008-11-17  Christian Dywan  <christian@imendio.com>

	Bug 377699 – realizing gtk.Progress() causes SEGV

	* gtk/gtkprogress.c: Define GtkProgress as an abstract type

2008-11-13  Christian Dywan  <christian@imendio.com>

	Bug 560602 – Wrong GtkMenuItem default value (test fails)

	* gtk/gtkmenuitem.c (gtk_menu_item_class_init):
	Correct default "label" value to ""

2008-11-12  Christian Dywan  <christian@imendio.com>

	Bug 560139 – GtkEntry doesn't paint with the right state

	* gtk/gtkentry.c (gtk_entry_class_init), (gtk_entry_draw_frame),
	(gtk_entry_expose): Reflect the right state if state-hint is set

2008-11-12  Christian Dywan  <christian@imendio.com>

	Bug 559619 – invisible-char default cannot be tested

	* gtk/tests/defaultvalue.c (test_type):
        Skip invisible-char when testing

2008-11-12  Richard Hult  <richard@imendio.com>

	* gtk/gtkdnd-quartz.c: (gtk_drag_set_icon_pixmap): Implement,
	patch from Paul Davis.

2008-11-12  Christian Dywan  <christian@imendio.com>

	Bug 525550 – GTK+ 2.13.0 GtkCurve test fails

	* gtk/tests/object.c (list_ignore_properties),
	(object_test_property), (main): Ignore GtkCurve when testing

2008-11-12  Richard Hult  <richard@imendio.com>

	Bug 550942 – [patch] Rework of gdkeventloop-quartz.c

	* gdk/gdk.c:
	* gdk/gdkinternals.h: Add eventloop debug facility.
	* gdk/quartz/gdkeventloop-quartz.c: Big rework of the quartz
	mainloop integration, patch from Owen Taylor. See bug #550942 for
	the details.

2008-11-12  Richard Hult  <richard@imendio.com>

	Bug 558586 – handling of keyboard under darwin (quartz)

	* gdk/quartz/gdkkeys-quartz.c: Follow up on this bug, only use the
	new API when building on 64-bit, since there are still old non-xml
	layouts used out there we don't want to break them. (For 64-bit
	those layouts doesn't work so we don't have a choice there.)

2008-11-11  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtkspinbutton.c: Chain up in enter and leave notify handlers.

2008-11-11  Michael Natterer  <mitch@imendio.com>

	Bug 553765 – Add orientation API to GtkRange

	* gtk/gtkrange.[ch]: implement the GtkOrientable interface. Add
	evil code that makes sure that the stepper_detail and slider_detail
	set in GtkRangeClass continue to work with the hacked subclasses
	below.

	* gtk/gtkscale.[ch]: swallow all code from GtkHScale and GtkVScale
	and add gtk_scale_new() and gtk_scale_new_with_range() which take
	a GtkOrientation argument. Set slider_detail to "Xscale" so above
	evil code works.

	* gtk/gtkscrollbar.[ch]: add gtk_scrollbar_new() which takes a
	GtkOrientation argument. Set stepper_detail to "Xscrollbar" so
	above evil code works.

	* gtk/gtkhscale.c
	* gtk/gtkvscale.c
	* gtk/gtkhscrollbar.c
	* gtk/gtkvscrollbar.c: remove all code except the constructor and
	call gtk_orientable_set_orientation() in init().

	* gtk/gtk.symbols: changed accordingly.

2008-11-11  Michael Natterer  <mitch@imendio.com>

	* gtk/gtktoolbar.h: move deprecated functions together, move
	setters and getters together, some indentation cleanup.

2008-11-11  Michael Natterer  <mitch@imendio.com>

	* gtk/gtktoolbar.[ch]: implement the GtkOrientable interface
	and deprecate gtk_toolbar_get,set_orientation().

	* gtk/gtk.symbols: changed accordingly.

2008-11-10  Marek Kasik  <mkasik@redhat.com>

	Bug 560135 - Print when the user double clicks a printer

	* gtk/gtkprintunixdialog.c: add handling of double click to
	GtkPrintUnixDialog.

2008-11-07  Michael Natterer  <mitch@imendio.com>

	* gtk/gtkpaned.c: argh, actually call the newly added private
	gtk_paned_calc_position() instead of the deprecated public
	version.

2008-11-07  Michael Natterer  <mitch@imendio.com>

	Bug 553586 – Add orientation API to GtkPaned

	* gtk/gtkpaned.[ch]: implement the GtkOrientable interface
	and swallow all code from GtkHPaned and GtkVPaned. Add
	gtk_paned_new() which takes a GtkOrientation argument. Deprecate
	gtk_paned_compute_position() for good (also for GTK_COMPILATION).

	* gtk/gtkhpaned.[ch]
	* gtk/gtkvpaned.[ch]: remove all code except the constructor and
	call gtk_orientable_set_orientation() in init().

	* gtk/gtk.symbols: add gtk_box_new().

2008-11-07  Johan Dahlin  <jdahlin@async.com.br>

	* gtk/gtkcontainer.c (gtk_container_buildable_add_child):
	Check for child->parent instead of GTK_WIDGET_TOPLEVEL.

2008-11-07  Michael Natterer  <mitch@imendio.com>

	* gtk/gtkscrollbar.c: remove bogus newlines in the middle of
	function calls, fix broken indentation and remove trailing
	whitespace.

2008-11-06  Tristan Van Berkom <tvb@gnome.org>

	* gtk/gtkmenuitem.c: Made buildable and added support for adding
	children of type "submenu"

	* gtk/gtkwindow.c: Added support for custom tag "accel-groups" to
	add GtkAccelGroups to the window.

	* gtk/gtkcontainer.c: Added builder contextual warnings in
	buildable_add_child()

	* gtk/tests/builder.c: Added tests for buildable menus (test that
	accelerators are properly connected on stock items, test the menu
	hierarchy, test permission to add alien/custom menuitem children).

	* docs/reference/gtk/tmpl/gtkbuilder.sgml
	* docs/reference/gtk/tmpl/gtkwindow.sgml
	* docs/reference/gtk/tmpl/gtkmenuitem.sgml: Updated docs for
	buildable submenus and accel groups.

2008-11-06  Tristan Van Berkom <tvb@gnome.org>

	* gtk/gtkmenuitem.[ch]: added new apis
	gtk_menu_item_[set/get]_label() and
	gtk_menu_item_[set/get]_use_underline() with "label" and
	"use-underline" properties, constructors cleaned up to use
	g_object_new().  GtkMenuItemClass take new vfuncs
	->get/set_label().

	* gtk/gtkcheckmenuitem.c: constructors cleaned up to use
	g_object_new().

	* gtk/gtkimagemenuitem.[ch]: added new apis
	gtk_image_menu_item_[get/set]_use_stock() and
	gtk_image_menu_item_set_accel_group() with "use-stock" and
	write-only "accel-group" properties. constructors cleaned up to
	use g_object_new().

2008-11-06  Tristan Van Berkom <tvb@gnome.org>

	* gtk/gtkbuilder.h: Fixed a crasher in
	GTK_BUILDER_WARN_INVALID_CHILD_TYPE()

2008-11-06  Tristan Van Berkom <tvb@gnome.org>

	* gtk/gtklabel.c: gtk_label_set_attributes() now applies attributes
	on top of any markup or mnemonic attributes (bug 558409).

	* README: Updated and added release notes for 2.16

2008-11-06  Richard Hult  <richard@imendio.com>

	Bug 558586 – handling of keyboard under darwin (quartz)

	* gdk/quartz/gdkkeys-quartz.c: (maybe_update_keymap): Patch from
	Arnaud Charlet to replace use of deprecated keyboard layout API
	with the new TIS API available in 10.5. The old code is still used
	when building for 10.4.

2008-11-05  Richard Hult  <richard@imendio.com>

	* gdk/quartz/gdkevents-quartz.c:
	(get_keyboard_modifiers_from_ns_event), (create_key_event): Revert
	(at least for now) the alt/cmd switching since it breaks the
	"alt-gr" functionality of alt which makes it impossible to input
	lots of characters.

2008-11-05  Christian Dywan  <christian@imendio.com>

	Bug 559404 – gtk_editable_insert_text counts length in bytes

	* gtk/gtkeditable.c:
	Document new_text_length as the number of bytes

2008-11-05  Richard Hult  <richard@imendio.com>

	* gdk/quartz/gdkwindow-quartz.c:
	(gdk_window_impl_quartz_begin_paint_region): Set the fill color
	outside the loop.

2008-11-05  Richard Hult  <richard@imendio.com>

	* gtk/gtkstatusicon.c: (gtk_status_icon_set_has_tooltip),
	(gtk_status_icon_get_tooltip_markup): Fix build for win32 and
	quartz.

2008-11-04  Tor Lillqvist  <tml@novell.com>

	Bug 557212 - Problem with which window gains focus and is visible

	* gdk/win32/gdkevents-win32.c (ensure_stacking_on_activate_app):
	Only do the restacking for the active window of the
	application. Seems to fix the problem.

	(gdk_event_translate): Only call ensure_stacking_on_activate_app()
	when the application is being activated, not deactivated.

2008-11-03  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtk.symbols:
	* gtk/gtkstatusicon.[hc]: Add new tooltip api.

2008-11-03  Christian Persch  <chpe@gnome.org>

	Bug 558001 – gtk_icon_view_enable_model_drag_[source|dest] problem

	* gtk/gtkiconview.c: Make gtk_drag_*_add_*_targets() usable with
	GtkIconView.

2008-11-02  Matthias Clasen  <mclasen@redhat.com>

	Bug 558929 – gtkstatusicon.c: 'event' is a member of the structure

	* gtk/gtkstatusicon.c: Fix the build.

2008-11-02  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtkimagemenuitem.c: Make it possible to overrule the
	gtk-menu-images setting.

	* gtk/gtkaction.c (connect_proxy): Show the image before adding
	it to the image menu item.

2008-11-01  Tor Lillqvist  <tml@novell.com>

	Bug 558278 - Crash when calling a callback set by
	gdk_add_client_message_filter()

	* gdk/win32/gdkevents-win32.c (apply_event_filters): Rename from
	apply_filters() so that it is clear that this function is for
	GdkEventFilters only.

	(print_event): Print more information for GDK_CLIENT_EVENT events.

	(gdk_event_translate): When handling client filters, don't use
	apply_event_filters(). Use similar code as in the X11 backend,
	although not exactly, as the parameter list and return value
	semantics of gdk_event_translate() is different.

	* tests/testclientmessage.c: New interactive test program to
	verify client message functionality.

	* tests/Makefile.am: Add it.

2008-11-01  Matthias Clasen  <mclasen@redhat.com>

	Bug 409435 – GtkStatusIcon enhancements: DnD, scroll events, 
	middle click, rich tooltips

	* gtk/gtkstatusicon.[hc]: Add support for button press/release and
	scroll events. Patch by Ed Catmur

2008-11-01  Matthias Clasen  <mclasen@redhat.com>

	Bug 322934 – Replace menu's proxy icons with empty space hiding icons

	* gtk/gtkmenu.c (gtk_menu_size_request): Use consistent padding
	regardless of imagees or checks being in the menu. Also add
	padding on the right edge.
	Proposal by Luca Ferretti, patch by Jon McCann

2008-11-01  Matthias Clasen  <mclasen@redhat.com>

	Bug 412134 – Add API to query style properties from the style

	* gtk/gtk.symbols:
	* gtk/gtkstyle.[hc]: Add getters for style properties to
	avoid the need for ugly workarounds with dummy widget instances.
	Patch by Mariano Suárez-Alvarez

2008-10-31  Christian Dywan  <christian@imendio.com>

	Bug 558667 – gtk_font_selection_dialog_get_apply_button - deprecate?

	* gtk/gtk.symbols:
	* gtk/gtkfontsel.c:
	* gtk/gtkfontsel.h:
	Deprecate gtk_font_selection_dialog_get_apply_button

2008-10-31  Matthias Clasen  <mclasen@redhat.com>

	Bug 558323 – glitches when popping up combos in treeviews

	* gtk/gtkcellrenderercombo.c (gtk_cell_renderer_combo_set_property):
	Don't set the model property on the combo box, since that leads
	to loops.

2008-10-31  Christian Dywan  <christian@imendio.com>

	Bug 347230 – testicontheme shortcomings

	* tests/testicontheme.c (main):
	Use theme for "display" and quit on window closing

2008-10-30  Matthias Clasen  <mclasen@redhat.com>

	Bug 558522 – scroll arrow painted insensitive even though there
	are pages beyond the edge

	* gtk/gtknotebook.c (gtk_notebook_real_insert_page): Redraw
	arrows. Pointed out by Christian Persch

2008-10-30  Michael Natterer  <mitch@imendio.com>

	* gtk/gtkcellrenderertext.h
	* gtk/gtkentry.[ch]
	* gtk/gtkimcontext.h
	* gtk/gtklabel.c
	* gtk/gtkstyle.h: <pango/pango.h> is pulled in by <gdk/gdk.h>,
	remove its inclusion here.

2008-10-30  Michael Natterer  <mitch@imendio.com>

	* gtk/*.h: no need to include <gtk/gtkenums.h> in headers which
	somehow include gtkobject.h or another header which includes it.

2008-10-30  Marek Kasik  <mkasik@redhat.com>

	Bug 339714 - Set printer dpi on cairo ps/pdf surfaces when printing

	* gtk/gtk.symbols
	* gtk/gtkprintsettings.c
	* gtk/gtkprintsettings.h
	* docs/reference/gtk/gtk-sections.txt
	* modules/printbackends/file/gtkprintbackendfile.c
	* modules/printbackends/test/gtkprintbackendtest.c
	* modules/printbackends/cups/gtkprintbackendcups.c
	* modules/printbackends/lpr/gtkprintbackendlpr.c:
	Added lpi (lines per inch) setting to GtkPrintSettings and support
	for anamorphic dpi. Surface fallback resolution is set to 2*lpi.

2008-10-30  Michael Natterer  <mitch@imendio.com>

	* gtk/*.h: no need to include <gdk/gdk.h> in any widget header,
	it's included via gtkwidget.h anyway.

2008-10-30  Sven Neumann  <sven@gimp.org>

	* gtk/gtkwidget.c (gtk_widget_get_property): removed redundant
	conditional.

2008-10-30  Christian Dywan  <christian@imendio.com>

	Bug 557316 – GtkLinkButton should consider user-defined tooltip

	* gtk/gtklinkbutton.c (gtk_link_button_query_tooltip_cb):
	Only override the tooltip if not previously set

2008-10-29  Christian Dywan  <christian@imendio.com>

	Bug 557762 – Misleading error message in GDK DirectFB

	* gdk/directfb/gdkdisplay-directfb.c (gdk_display_open):
	Correctly say GetInputDevice instead of GetDisplayLayer

2008-10-29  Christian Dywan  <christian@imendio.com>

	Bug 558397 – gtk_widget_error_bell undefined without a screen

	* gtk/gtkwidget.c (gtk_widget_error_bell): Test the settings
	instance and return silently if unset

2008-10-28  Michael Natterer  <mitch@imendio.com>

	* gdk/keyname-table.h: fix small typo.

2008-10-27  Richard Hult  <richard@imendio.com>

	Bug 557894 – Wrong return value for
	gdk_pointer_grab_info_libgtk_only()

	* gdk/quartz/gdkevents-quartz.c:
	(gdk_pointer_grab_info_libgtk_only): Return TRUE when there is a
	pointer grab. Patch by Owen Taylor.

2008-10-26  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtktoolshell.c:
	* gtk/gtktoolitem.c: Remove markup from short descriptions.

2008-10-26  Matthias Clasen  <mclasen@redhat.com>

	* gdk/keyname-table.h:
	* gtk/gen-paper-names.c:
	* gtk/paper_names_offsets.c:
	* gtk/gtkpapersize.c:
	* gtk/gtkaccellabel.c:
	* gtk/gtkprintoperation.c:
	* gtk/gtkstock.c: More conversion to C_().

2008-10-26  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtkaccellabel.c:
	* gtk/gtkcalendar.c:
	* gtk/gtkcellrendereraccel.c:
	* gtk/gtkcellrendererprogress.c:
	* gtk/gtkimmulticontext.c:
	* gtk/gtkrecentchoosermenu.c:
	* gtk/gtkvolumebutton.c: Use C_() instead of Q_(). String change!

2008-10-26  Christian Persch  <chpe@gnome.org>

	Bug 557065 – gtkcellrendererpixbuf spams console over and over with
	'could not load image' warnings

	* gtk/gtkcellrendererpixbuf.c:
	(gtk_cell_renderer_pixbuf_create_themed_pixbuf): Remove noisy
	g_warning.

2008-10-26  Philip Withnall  <philip@tecnocode.co.uk>

	Bug 530454 – Clarify page_nr when printing

	* gtk/gtkprintoperation.c (gtk_print_operation_class_init): Point out
	that page_nr is 0-based in the documentation.

2008-10-25  Matthias Clasen  <mclasen@redhat.com>
	
	Bug 557315 – stale clipboard target cache

	* gtk/gtkclipboard.c (gtk_clipboard_set_contents): Remove cached
	targets. Pointed out by Evan Stade

2008-10-24  Tristan Van Berkom  <tvb@gnome.org>

	* gtk/gtkwidget.c: Added a note about GtkWidget:has-tooltip in
	the docs for GtkWidget::query-tooltip.

2008-10-24  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtkmountoperation.c: The "screen" property ought to have
	type GdkScreen, not GtkWindow. Found by Cosimo Cecchi

2008-10-24  Matthias Clasen  <mclasen@redhat.com>

	Bug 556954 – gtk+/gtk/gtkrecentchooserdefault.c: mismatching
	allocation and deallocation

	* gtk/gtkrecentchooserdefault.c (remove_selected_from_list): Don't
	free a strdup'ed string by g_free. Pointed out by Daniel Marjamäki

2008-10-24  Matthias Clasen  <mclasen@redhat.com>

	Bug 556835 – gtkentry.c: variable is declared at middle of block

	* gtk/gtkentry.c (gtk_entry_copy_clipboard): Fix a C99ism pointed
	out by Kazuki Iwamoto

2008-10-24  Matthias Clasen  <mclasen@redhat.com>

	Bug 557524 – "va_end(args);" should be added into
	gtk_text_buffer_insert_with_tags_by_name( )

	* gtk/gtktextbuffer.c (gtk_text_buffer_insert_with_tags_by_name):
	Don't forget to call va_end. Pointed out by Boram Park

2008-10-23  Alexander Larsson  <alexl@redhat.com>

	Bug 528320 - Incorrect icons displayed for files with custom
	mimetype icons
	
        * gtk/gtkfilesystem.c:
        (_gtk_file_info_render_icon):
	Fall back on default file icon if there was no icon or it
	was not found in the theme. This goes with the corresponding
	change in glib to not add the fallback icon, but is useful
	in other cases too.

2008-10-22  Behdad Esfahbod  <behdad@gnome.org>

	Bug 555920 – gtkentry.c passes wrong enum to
	pango_layout_set_alignment()

	* gtk/gtkentry.c (gtk_entry_create_layout): Don't set layout
	adjustment.

2008-10-22  Matthias Clasen  <mclasen@redhat.com>

	* gdk/x11/gdkscreen-x11.c: Only emit size-changed if the screen
	size actually changed.

2008-10-21  Michael Natterer  <mitch@imendio.com>

	* gdk/gdkdraw.c
	* gdk/gdkimage.c
	* gdk/gdkscreen.c
	* gdk/gdkwindow.c: replace assertions for obj != NULL by
	GDK_IS_OBJ(), remove redundant != NULL checks when there is
	already a type check, add some g_return_if_fail() that were
	missing entirely, fix some broken indentation and spacing.

2008-10-21  Tor Lillqvist  <tml@novell.com>

	Bug 557266 - Window Management Problem

	Also reported in mail to gtk-list, and of course it has been well
	known in general that window state management is messy and buggy
	in various ways in gdk/win32.

	* gdk/win32/gdkwindow-win32.c (show_window_internal): Correct
	handling of GDK_WINDOW_STATE_ABOVE windows. It doesn't work to set
	the WS_EX_TOPMOST extended style bit using SetWindowLong(). We
	must call SetWindowPos() on the window using HWND_TOPMOST
	instead. The description for WS_EX_TOPMOST in the documentation
	for CreateWindowEx() even implies that if you read it carefully.

2008-10-21  Michael Natterer  <mitch@imendio.com>

	* gdk/gdkapplaunchcontext.c: reorder functions to be in standard
	order, add prototypes and namespace to static functions, add
	g_return_if_fail()s which were missing all over the place.

2008-10-20  Christian Persch  <chpe@gnome.org>

	Bug 557059 – crash when compositing emblems with icon

	* gtk/gtkicontheme.c: (apply_emblems): Copy the pixbuf before using it
	with gtk_pixbuf_composite, in case its pixdata is read-only (mmaped
	from icon cache or builtins).

2008-10-20  Murray Cumming  <murrayc@murrayc.com>

	* gtk/gtkiconview.c: gtk_icon_view_set_tooltip_row(), 
	gtk_icon_view_set_tooltip_item():
	* gtk/gtktreeview.c: gtk_icon_view_set_tooltip_row(), 
	gtk_icon_view_set_tooltip_cell():
	Documentation: Mention the simple set_tooltip_column() 
	alternative.

2008-10-18  Tor Lillqvist  <tml@novell.com>

	* gdk/win32/gdkevents-win32.c (gdk_event_translate): On
	WM_WINDOWPOSCHANGING, don't dereference windowpos in the debugging
	output without setting it first.

2008-10-18  Tor Lillqvist  <tml@novell.com>

	Bug 556578 - GIMP windows stay on top of other windows

	* gdk/win32/gdkevents-win32.c (ensure_stacking_on_unminimize)
	(ensure_stacking_on_window_pos_changing)
	(ensure_stacking_on_activate_app): Ignore unmapped windows in the
	loops where we look for the lowest "transient-type" window.

	(gdk_event_translate): Don't call
	ensure_stacking_on_window_pos_changing() or
	ensure_stacking_on_activate_app() for unmapped windows.

2008-10-16  Marek Kasik  <mkasik@redhat.com>

	Bug 556527 - The current page property is not passed to
	GtkPrintUnixDialog

	* gtk/gtkprintoperation-unix.c: pass current-page property
	to GtkPrintUnixDialog

2008-10-15  Michael Natterer  <mitch@imendio.com>

	* gdk/gdkapplaunchcontext.h (GDK_IS_APP_LAUNCH_CONTEXT): fix typo
	in the type name so the macro becomes usable.

2008-10-14  Christian Dywan  <christian@imendio.com>

	556150 – gtk 'object' property test fixing

	* gtk/tests/object.c (list_ignore_properties):
        Remove some recently fixed properties from the exception list

2008-10-13  Matthias Clasen  <mclasen@redhat.com>

	Bug 555779 – GtkCellRendererPixbuf crashed on failed GIcon lookup

	* gtk/gtkcellrendererpixbuf
	(gtk_cell_renderer_pixbuf_create_themed_pixbuf): Don't crash
	if a GIcon is not present in the current theme. Patch by 
	Alex Larsson.

2008-10-13  Matthias Clasen  <mclasen@redhat.com>

	Bug 552318 – menubar mnemonics consumed even when
	gtk-enable-mnemonics=false

	* gtk/gtkwindow.c (gtk_window_activate_key): Don't let mnemonic
	entries block accelerator activation when gtk-enable-mnemonics is
	FALSE. Problem reported by Andreas Moog.

2008-10-13  Cody Russell <cody@jhu.edu>

	* test/testfilechooser.c: Fix option parsing so that -a and
	--action work correctly.

2008-10-13  Christian Persch <chpe@gnome.org>

	Bug 555386 – format not a string literal and no format arguments

	* gtk/gtkiconfactory.c
	* gtk/gtkprintbackend.c
	* gtk/gtkprintoperation.c
	* gtk/gtkthemes.c
	* gtk/tests/builder.c
	* modules/other/gail/gailtextview.c
	* tests/testmerge.c: Use printf safely.

2008-10-13  Christian Persch <chpe@gnome.org>

	Bug 555724 – gtkcellrendereraccel not initialised correctly

	* gtk/gtkcellrendereraccel.c: Initialise the cell text.

2008-10-12  Simos Xenitellis  <simos@gnome.org>

	Bug 555625 – Updated gtk_compose_seqs_compact table 
	(gtkimcontextsimpleseqs.h)
	
	* gtk/gtkimcontextsimpleseqs.c: Updated the compose sequence table.
	In this update we removed a further set of compose sequences that
	are otherwise covered by check_algorithmically(). 

	* gtk/gtkimcontextsimple.c: Updated table value that shows how many 
	distinct first values exist in the compose sequences. 
	Change from 22 to 20.
	
2008-10-11  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtktoolbar.c: Revert the GtkSettings::gtk-toolbar-icon-size
	part of the previous change, since it doesn't work correctly without
	extra complication, and using custom icon sizes doesn't make too
	much sense in a desktop-wide setting.

2008-10-11  Matthias Clasen  <mclasen@redhat.com>

	Bug 555186 – Setting gtk-toolbar-icon-size with custom icon_size

	* gtk/gtktoolbar.c: Turn GtkToolbar::icon-size and
	GtkSettings::gtk-toolbar-icon-size into int properties, to
	allow the use of app-registered icon sizes.

2008-10-11  Christian Dywan  <christian@imendio.com>

	Bug 555676 – gtk_widget_real_grab_focus assumes toplevel == window

	* gtk/gtkwidget.c (gtk_widget_real_grab_focus):
        Actually test for GTK_IS_WINDOW *and* GTK_WIDGET_TOPLEVEL

2008-10-10  Behdad Esfahbod  <behdad@gnome.org>

	Bug 551355 – [PATCH] Make glib build with libtool 2.2

	* autogen.sh: Accept libtool 2.2.   We are moving towards having
	it working.

2008-10-10  Richard Hult  <richard@imendio.com>

	* gdk/quartz/gdkkeys-quartz.c: (gdk_keymap_get_caps_lock_state)
	Add empty stub to fix linking.

2008-10-10  Simos Xenitellis  <simos@gnome.org>

	Bug 555000 – Wrong treatment on non-spacing marks dead keys in 
	GtkIMContextSimple

	* gtk/gtkimcontextsimple.c: Change IS_DEAD_KEY() macro so that
	it only checks if input is a deadkey keysym.

2008-10-09  Christian Dywan  <christian@imendio.com>

	Bug 555676 – gtk_widget_real_grab_focus assumes toplevel == window

	* gtk/gtkwidget.c (gtk_widget_real_grab_focus):
        Test for GTK_IS_WINDOW instead of GTK_WIDGET_TOPLEVEL

2008-10-09  Christian Dywan  <christian@imendio.com>

	Bug 555573 – gtk_font_selection_set_font_name
        shouldn't require a screen

	* gtk/gtkfontsel.c (gtk_font_selection_set_font_name):
        Don't warn if there is no screen, just return FALSE

2008-10-09  Christian Dywan  <christian@imendio.com>

	Bug 555523 – gtk_scale_button_set_adjustment should accept NULL

	* gtk/gtkscalebutton.c (gtk_scale_button_set_adjustment):
	Create a new adjustment if NULL is passed, like other widgets

2008-10-09  Christian Dywan  <christian@imendio.com>

	Bug 555578 – GtkTable propertiy maxima are wrong

	* gtk/gtktable.c (gtk_table_class_init), (gtk_table_resize):
        Always use 65535 instead of G_MAXUINT since that is
        the actually supported maximum number of columns and rows

2008-10-09  Richard Hult  <richard@imendio.com>

	Bug 550342 – Splash screens have a caption

	* gdk/quartz/gdkwindow-quartz.c: (_gdk_window_new),
	(gdk_window_set_decorations): Patch from Marianne Gagnon to make
	splash windows borderless.

2008-10-09  Michael Natterer  <mitch@imendio.com>

	Bug 516425 – Optionally display accelerators in popups

	* gtk/gtkuimanager.h (enum GtkUIManagerItemType): add value
	GTK_UI_MANAGER_POPUP_WITH_ACCELS which works like _POPUP but
	shows the actions' accelerators.

	* gtk/gtkuimanager.c: honor the new enum value for programmatically
	created UIs, and support <popup accelerators="true"> in the XML
	for the same purpose.

2008-10-09  Simos Xenitellis  <simos@gnome.org>

	Bug 554192 – double press on the "circumflex" dead key 
	(standard french 105 keyboard) no longer produces the "^" character

	* gtk/gtkimcontextsimple.c (gtk_im_context_simple_filter_keypress):
	Changed the order, put check_compact_table() first, then 
	check_algorithmically().

2008-10-08  Christian Persch  <chpe@gnome.org>

        Bug 554702 – gtkfilesystem leaks GError

        * gtk/gtkfilesystem.c (_gtk_file_system_init): Free the GError.

2008-10-08  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtkfilechooserdefault.c (update_current_folder_get_info_cb):
	Don't forget to reset reload_state when current_folder is already
	correct. Fixes https://bugzilla.redhat.com/show_bug.cgi?id=465992

2008-10-08  Christian Dywan  <christian@imendio.com>

	Bug 555270 – Allow unsetting a MessageDialog's image

	* gtk/gtkmessagedialog.c (gtk_message_dialog_set_property),
        Remove a superfluous cast to GtkWidget*
	(gtk_message_dialog_set_image): Accept NULL for the image
	and unset the image in that case.

2008-10-08  Christian Dywan  <christian@imendio.com>

	Bug 436533 – Allow more space efficient scroll arrows placement

	* gtk/gtkenums.h: Add GtkArrowPlacement
	* gtk/gtkmenu.c (gtk_menu_class_init), (get_arrows_border),
	(get_arrows_visible_area), (get_double_arrows),
	(get_arrows_sensitive_area): Implement GtkMenu::arrow-placement
        to allow scrolling arrows to be placed at the start, end or both
        Patch by Tommi Komulainen and myself

2008-10-08  Christian Dywan  <christian@imendio.com>

	Bug 555387 – Changing the sensitivity of a statusbar
	mistakenly requires a display

	* gtk/gtkstatusbar.c (set_grip_cursor): Only change the cursor
        of the resize grip if there is a grip window.

2008-10-06  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtktooltip.c (gtk_tooltip_show_tooltip): Avoid unitialized
	memory warnings from valgrind.

2008-10-07 11:03:30  Tim Janik  <timj@imendio.com>

	* gtk/gtkbox.h: keep GtkBox as an abstract type and keep _gtk_box_new()
	as private function until we settle on the exact semantics.
	renamed _gtk_box_set_old_defaults() as suggested by Mitch.

2008-10-07  Michael Natterer  <mitch@imendio.com>

	* gtk/gtkbox.c: reindent static prototypes.

2008-10-07  Michael Natterer  <mitch@imendio.com>

	Bug 553573 – Add orientation API to GtkBox

	* gtk/gtkbox.[hh]: implement the GtkOrientable interface and
	swallow all code from GtkHBox and GtkVBox. Add gtk_box_new()
	which takes a GtkOrientation argument. Also move the newly
	added "spacing_set" boolean from struct GtkBox to the new
	private struct.

	* gtk/gtkhbox.[ch]
	* gtk/gtkvbox.[ch]: remove all code except the constructor and
	call gtk_orientable_set_orientation() in init().

	* gtk/gtk.symbols: add gtk_box_new().

2008-10-06  Björn Lindqvist  <bjourne@gmail.com>

	Bug 539464 – gtk_cell_view_get_model is missing in GtkCellView

	* gtk/gtkcellview.c (gtk_cell_view_get_model): Add
	gtk_cell_view_get_model.

2008-10-06  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtkprintunixdialog.c (create_main_page): Show the tooltip
	on the range entry itself, too.

2008-10-04  Tor Lillqvist  <tml@novell.com>

	Bug 132501 - Make utility window translate to tool window in win32

	Implement the utility window type hint. Such windows are kept on
	top of other windows of the same process. Makes GIMP's toolbox and
	dock windows behave more like in GNOME under metacity. Apply the
	same logic also to windows marked with the dialog window type
	hint, and windows that are transient for some other window. I'll
	call such windows "transient-type" below.

	* gdk/win32/gdkevents-win32.c (doesnt_want_key): Drop unused
	variables.

	(ensure_stacking_on_unminimize)
	(ensure_stacking_on_window_pos_changing)
	(ensure_stacking_on_activate_app): New functions to implement the
	desired stacking order. Make sure that a window that is not
	transient-type stays below any transient-type windows of the
	application. When activating a non-transient-type window make sure
	it rises as high as possible while still staying below the lowest
	transient-type window.

	(gdk_event_translate): Call above functions on
	WM_WINDOWPOSCHANGING, WM_ACTIVATEAPP and on WM_SIZE when
	unminimizing. Improve debugging printout.

	* gdk/win32/gdkwindow-win32.c (get_effective_window_decorations):
	Handle utility windows like toolbar windows.

	(gdk_window_new_internal) (update_style_bits): Give utility
	windows the WS_EX_TOOLWINDOW extended style.

	(gdk_window_set_title): If debugging "misc" or "events", make the
	handle of top-level windows show up in their title bars. Very
	useful when looking at debugging output.

	(gdk_window_set_transient_for) (gdk_window_set_keep_above)
	(gdk_window_set_keep_below) (gdk_window_set_modal_hint)
	(gdk_window_set_skip_taskbar_hint)
	(gdk_window_set_skip_pager_hint): Add and improve debugging
	printout.

	(gdk_window_set_type_hint): Print hint symbolically in GDK_NOTE().

2008-10-04  Tor Lillqvist  <tml@novell.com>

	* gdk/win32/gdkmain-win32.c (_gdk_win32_window_exstyle_to_string)
	(_gdk_win32_window_pos_bits_to_string): New debugging printout
	functions. Decode the WS_EX_* and SWP_* bits.

	* gdk/win32/gdkprivate-win32.h: Declare them. Define
	GDK_DEBUG_MISC_OR_EVENTS for use in GDK_NOTE() to match either
	"misc" or "events".

2008-10-03  Matthias Clasen <mclasen@redhat.com>

	* gtk/gtkmodules.c (_gtk_modules_settings_changed): Add some
	debug output.

2008-10-02  Matthias Clasen <mclasen@redhat.com>

	Bug 96431 – Can't cut and paste / DND within invisible entry

	* gtk/gtkentry.c: Disable cut, copy and drag out of an invisible
	entry. Proposed by Owen Taylor

2008-10-02  Matthias Clasen <mclasen@redhat.com>

	Bug 530575 – GtkEntry with invisible chars has a confused cursor in
	overwrite mode

	* gtk/gtkentry.c (gtk_entry_draw_cursor): Use the visible text
	in the layout when positioning the cursor, not the actual text
	content of the entry. This makes a different when using overwrite
	mode in an invisible entry. 
	Problem noticed by Jonathan Blandford

	* gtk/gtktextutil.c: Fix a typo in a comment

2008-10-02  Christian Persch

        Bug 554704 – gtkfilesystemmodel does too much work

        * gtk/gtkfilesystemmodel.c: Replace g_slist_length()<1 check with a
        simple NULL check.

2008-10-02  Christian Persch

        Bug 554701 – filechooser spams console with useless warnings

        * gtk/gtkfilesystem.c.c: Don't warn if the async call was simply
        cancelled.

2008-10-02  Christian Persch

        Bug 554698 – mem leak in filechooser

        * gtk/gtkfilechooserdefault.c: Plug a mem leak.

2008-10-02  Christian Persch

        Bug 554696 – invalid free function used

        * gtk/gtkfilesystemmodel.c: Use the right free func.

2008-10-02  Christian Persch

        Bug 554691 – mem leak in filechooser

        * gtk/gtkfilesystemmodel.c: Plug a mem leak.

2008-10-02  Christian Persch

        Bug 554690 – mem leak in filechooser

        * gtk/gtkfilechooserdefault.c: Plug a mem leak.

2008-10-02  Michael Natterer  <mitch@imendio.com>

	Bug 553585 – Add orientation API to GtkRuler

	* gtk/gtkruler.[ch]: implement the GtkOrientable interface and
	swallow all code from GtkHRuler and GtkVRuler. Add gtk_ruler_new()
	which takes a GtkOrientation argument.

	* gtk/gtkhruler.c
	* gtk/gtkvruler.c: remove all code except the constructor and
	call gtk_orientable_set_orientation() in init().

	* gtk/gtk.symbols: add gtk_ruler_new().

2008-10-01  Torsten Schoenfeld  <kaffeetisch@gmx.de>

	* docs/reference/gtk/gtk-sections.txt:
	* gtk/gtk.symbols:
	* gtk/gtkselection.c:
	* gtk/gtkselection.h: Add gtk_selection_data_get_selection to
	retrieve the sealed struct field GtkSelectionData.selection.

2008-10-01  Tor Lillqvist  <tml@novell.com>

	* gtk/gtkscalebutton.c: Don't #define _GNU_SOURCE on Windows as it
	confuses newest mingw headers.

2008-10-01  Tor Lillqvist  <tml@novell.com>

	* gdk/win32/gdkkeys-win32.c (gdk_keymap_get_caps_lock_state):
	Implement trivially on Windows. Not sure if something more complex
	is actually needed, more specifically whether the function needs
	to differentiate between "Caps Lock" and "Shift Lock" semantics?

2008-10-01  Simos Xenitellis  <simos@gnome.org>

	Bug 554506 – combining diacritics broken, became deadkeys

	* gtk/gtkimcontextsimple.c: added check if keysym is greater
	than 0x1000000, in this case it is not a dead key.

2008-09-30  Michael Natterer  <mitch@imendio.com>

	Bug 553582 – Add orientation API to GtkSeparator

	* gtk/gtkseparator.[ch]: implement the GtkOrientable interface and
	swallow all code from GtkHSeparator and GtkVSeparator. Add
	gtk_separator_new() which takes a GtkOrientation argument.

	* gtk/gtkhseparator.c
	* gtk/gtkvseparator.c: remove all code except the constructor and
	call gtk_orientable_set_orientation() in init().

	* gtk/gtk.symbols: add gtk_separator_new().

2008-09-30  Marek Kasik  <mkasik@redhat.com>

	Bug 344522 – support non-local destination files (GtkPrint):

	* gtk/gtkprintunixdialog.c
	* gtk/gtkprinteroptionwidget.c: Process URI instead of filename.
	* modules/printbackends/file/gtkprintbackendfile.c: Add ability
	to save files on non-local filesystems.

2008-09-30  Michael Natterer  <mitch@imendio.com>

	* gtk/gtk.symbols: forgot the G_GNUC_CONST of
	gtk_orientable_get_type().

2008-09-30  Michael Natterer  <mitch@imendio.com>

	Bug 541009 – Get rid of separate subclasses for horizontal and
	vertical orientation:

	* gtk/Makefile.am
	* gtk/gtk.symbols
	* gtk/gtk.h
	* gtk/gtkorientable.[ch]: add new interface GtkOrientable which
	will be implemented by everything that can switch orientation.

2008-09-30  Christian Dywan  <christian@imendio.com>

	Fix a typo in the tutorial.

	* docs/tutorial/gtk-tut.sgml: It's mnemonic, not 'mnemnonic'.

2008-09-29  Matthias Clasen  <mclasen@redhat.com>

	Bug 553086 – hard to see current immodule

	* gtk/gtkimmulticontext.c (gtk_im_multicontext_append_menuitems):
	Display the actually selected context in the system menuitem.
	Complaint by Akira Tagoh.

2008-09-29  Matthias Clasen  <mclasen@redhat.com>

	Bug 530568 – Entries with visibility=FALSE should warn for caps-lock
	on

	* gtk/gtkentry.c: Add a tooltip-like Caps Lock warning for
	password entries. The warning is also triggered if an input method
	is active. The warning can be turned off using the
	GtkEntry::caps-lock-warning property. 
	Proposed by Owen Taylor

2008-09-29  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtk.symbols:
	* gtk/gtkimmulticontext.[hc] (gtk_im_multicontext_get_context_id): 
	Add a getter for the the sealed context_id field.

2008-09-29  Matthias Clasen  <mclasen@redhat.com>

	Bug 107000 – Add signals to GdkKeymap for monitoring caps_lock, etc.

	* gdk/gdk.symbols:
	* gdk/gdkkeys.[ch]: Add a new GdkKeymap::state-changed signal, and
	a gdk_keymap_get_caps_lock_state function.

	* gdk/x11/gdkkeys-x11.c: Implement it here. For now, only emit
	state-changed when caps lock lockedness changes. 

	* gdk/x11/gdkdisplay-x11.c: Also select for modifier lock status
	changes in the XkbSelectEventDetails call.

2008-09-29  Kristian Rietveld  <kris@imendio.com>

	Bug 487624 - Tooltips doesn't get updated if ther's no mouse motion
	over widget

	* gtk/gtkwidget.c (gtk_widget_set_property): after updating
	tooltip text or markup, call gtk_widget_trigger_tooltip_query()
	so that existing visible tooltips are updated.

2008-09-29  Matthias Clasen  <mclasen@redhat.com>

	Bug 371908 – Password Entry broken
	Bug 317002 – Disable input method completely in GtkEntry when it's 
	in invisible mode.

	* gtk/gtkentry.c (gtk_entry_backspace): Make backspace behave
	properly when invisible.

	* gtk/gtkentry.c (gtk_entry_create_layout): Show preedit even if
	invisible. 

	* gtk/gtkentry.c (gtk_entry_set_visibility): Don't disable input
	methods when making the entry invisible.
	
2008-09-29  Emmanuele Bassi  <ebassi@linux.intel.com>

	* gdk/x11/gdkinput.c:
	(gdk_device_class_init), (gdk_device_finalize): Correctly chain
	up the finalize implementation.

2008-09-29  Richard Hult  <richard@imendio.com>

	Bug 554141 – uninitialized data use/free in gtkclipboard-quartz.c

	* gtk/gtkclipboard-quartz.c: (gtk_clipboard_wait_for_contents):
	Patch from Jon A. Cruz to initialize the allocated selection data.

2008-09-27  Matthias Clasen  <mclasen@redhat.com>

	Bug 339367 – Incorrect spotlocation

	* modules/input/gtkimcontextxim.c: Correct the spot location
	for on-the-spot style.

2008-09-27  Denis Washington  <denisw@svn.gnome.org>

	* gtk/gtkiconview.c: only draw keyboard focus when keyboard navigation
	is used, like GtkTreeView. (Bug #553575)

2008-09-26  Matthias Clasen  <mclasen@redhat.com>

	Bug 552959 – GtkTrayIcon: _NET_SYSTEM_TRAY_VISUAL and real
	transparency

	* gtk/gtktrayicon-x11.c: Add support for the _NET_SYSTEM_TRAY_VISUAL
	property described in
	http://lists.freedesktop.org/archives/xdg/2008-September/009919.html
	If _NET_SYSTEM_TRAY_VISUAL is a visual with an alpha channel, the 
	parent-relative-background hack is skipped and we draw with a real
	transparent background.

	* gtk/gtkrc.c: Remove the default GtkTrayIcon style, since the
	parent-relative background is now set when realizing the tray
	icon.

	Patch by Owen Taylor

2008-09-26  Matthias Clasen  <mclasen@redhat.com>

	Bug 552956 – Should check composite extension version

	* gdk/x11/gdkdisplay-x11.c: Check that the version of the
	composite extension is at least 0.4.
	Patch by Owen Taylor

2008-09-26  Matthias Clasen  <mclasen@redhat.com>
	
	Bug 553803 – eventually call XCloseDevice on XOpenDevice results

	* gdk/x11/gdkinput.c: Add a finalize function for device objects,
	and call XCloseDevice there. 

	* gdk/x11/gdkinput-x11.c:
	* gdk/x11/gdkdisplay-x11.c: Move freeing of device objects to
	the finalize function.
	Patch by Caolan McNamara
	
2008-09-26  Matthias Clasen  <mclasen@redhat.com>

	Bug 553578 - tabs are not drawn correctly

	* gtk/gtknotebook.c: Track the visibility state of notebook tabs 
	between allocations so that we know to redraw the tab labels if 
	tabs are hidden and shown without changing position. 
	Reported by Marek Kašík, patch by Owen Taylor.

2008-09-26  Matthias Clasen  <mclasen@redhat.com>

	Bug 553133 – GtkFileChooser won't ask to mount a volume
	Bug 553211 – GtkFileChooserButton unsets filter after first use

	* gtk/gtkfilechooserdefault.c (shortcuts_activate_volume): Use
	a GtkMountOperation when mounting, so that we get a password
	dialog when required.  

	* gtk/gtkfilechooserdefault.c (show_and_select_files): Also
	get the content-type, since it is used later on. 
	Pointed out by Davyd Madeley.

2008-09-26  Cody Russell  <bratsche@gnome.org>

	Bug 553917 – Typo in gdkwindow-win32.c

	* gdk/win32/gdkwindow-win32.c: Fixed a typo in
	update_system_menu().  Changed GDK_DECOR_ALL to GDK_FUNC_ALL.

	Reported by Richard Hult

2008-09-25  Marek Kasik  <mkasik@redhat.com>

	Bug 553241 – double freed pointer in lpr_write cause firefox3 crash

	* modules/printbackends/lpr/gtkprintbackendlpr.c:
	The redundant freeing of memory was removed.

	Patch by Chris Wang

2008-09-25  Michael Natterer  <mitch@imendio.com>

	* gtk/gtkfilechooserdefault.c (gtk_file_chooser_default_finalize):
	don't unref the file system backend, the newly added
	unset_file_system_backend() already does this (bug #553135).

2008-09-24  Michael Natterer  <mitch@imendio.com>

	* gtk/gtkeventbox.c: events return gboolean not gint, reindented
	static prototypes.

2008-09-24  Johan Dahlin  <johan@gnome.org>

	Bug 553385 – gtk-builder-convert creates untranslated combobox models

	* gtk/gtk-builder-convert: Set the translatable property on
	col tags for converted combos.

2008-09-24  Tor Lillqvist  <tml@novell.com>

	* gtk-zip.sh.in: Include all of share/man, lib/pkgconfig,
	share/aclocal and share/gtk-doc instead of trying to list
	individual files or subdirectories. We had missed gail.pc, for
	instance.

2008-09-24  Christian Dywan  <christian@imendio.com>

	Bug 538782 – Make GtkMenu's arrow size themable

	* gtk/gtkmenu.c (gtk_menu_class_init), (gtk_menu_paint):
        Implement "arrow-scaling" style property in GtkMenu.

2008-09-24  Christian Dywan  <christian@imendio.com>

	Bug 408244 – add GtkDialog::content-area-spacing

	* gtk/gtkbox.c (gtk_box_init), (gtk_box_set_spacing),
	(_gtk_box_set_spacing_set), (_gtk_box_get_spacing_set):
	* gtk/gtkbox.h:
	* gtk/gtkdialog.c (gtk_dialog_class_init), (update_spacings):
        Implement "content-area-spacing" style property in GtkDialog
        and internal helper _gtk_box_get_spacing_set in GtkBox.
        Patch by Tim Janik, Sven Herzberg and myself.

2008-09-24  Christian Dywan  <christian@imendio.com>

	Bug 541391 – Unfocussable Treeview swallows focus

	* gtk/gtktreeview.c (grab_focus_and_unset_draw_keyfocus),
	(gtk_tree_view_focus): Honor GTK_WIDGET_CAN_FOCUS properly

2008-09-24  Denis Washington  <denisw@svn.gnome.org>

	* gtk/gtkiconview.c: draw focus as a rectangle around the
	complete item, not just the text. (Bug #38254)

2008-09-23  Michael Natterer  <mitch@imendio.com>

	* gtk/gtkobject.c
	* gtk/gtksignal.[ch]: s/GtkType/GType/ and
	s/GtkSignalMarshaller/GSignalCMarshaller/.

2008-09-23  Michael Natterer  <mitch@imendio.com>

	* gdk/x11/gdkevents-x11.c (gdk_event_translate): remove unused
	variable and fix indentation.

2008-09-23  Michael Natterer  <mitch@imendio.com>

	* gtk/gtkclist.h
	* gtk/gtkctree.h
	* gtk/gtklist.h
	* gtk/gtklistitem.h
	* gtk/gtkobject.h
	* gtk/gtkoldeditable.h
	* gtk/gtkpixmap.h
	* gtk/gtkpreview.h
	* gtk/gtktext.h
	* gtk/gtktipsquery.h
	* gtk/gtktree.h
	* gtk/gtktreeitem.h: get rid of GtkType and GTK_CHECK_FOO() also
	in all deprecated headers.

2008-09-22  Matthias Clasen  <mclasen@redhat.com>

	Bug 553135 – eog crash: assertion failed. Gtk error:
	shortcuts_remove_rows: code should not be reached

	* gtk/gtkfilechooserdefault.c: Disconnect from GtkFileSystem 
	signals when we are destroyed, in order to avoid nasty surprises.
	Patch by Claudio Saavedra

2008-09-22  Emmanuele Bassi  <ebassi@linux.intel.com>

	Bug 552789 – Show size column in the search and recently used
	files modes

	* gtk/gtkfilechooserdefault.c: Display the file size column
	when in OPERATION_MODE_SEARCH. This removes a stat() call
	and simplifies the code a little bit by changing the query
	for file informations for each search engine hit.

2008-09-22  Michael Natterer  <mitch@imendio.com>

	* gtk/gtksignal.[ch]
	* gtk/gtkclist.c
	* gtk/gtklist.c
	* gtk/gtkmain.c
	* gtk/gtktext.c
	* gtk/gtktreeitem.c: use G_CALLBACK and GCallback instead of
	GTK_SIGNAL_FUNC and GtkSignalFunc also in deprecated code.

2008-09-22  Frederic Crozat  <fcrozat@mandriva.com>

	* gtk/gtkfilesystem.c: use the correct gi18n header.
	Fixes bug #553000.

2008-09-22  Michael Natterer  <mitch@imendio.com>

	* gtk/gtktoolbar.[ch]: add "Deprecated: 2.4" to all the deprecated
	append(), prepend() and insert() functions and recommend to use
	gtk_toolbar_insert() instead. Use GCallback instead of
	GtkSignalFunc even in deprecated API.

2008-09-20  Matthias Clasen  <mclasen@redhat.com>

	* gtk/gtkfilechooserbutton.c (filter_model_visible_func): Don't
	leak a GFile.

2008-09-19  Owen Taylor  <otaylor@redhat.com>

	Small cleanups to debug messages for GtkPlug/GtkSocket

	* gtk/gtksocket-x11.c: Fix debug message to say "Socket" not "Plug"
	* gtk/gtkplug-x11.c: Remove excess newlines from the ends of debug
	messages.

2008-09-19  Carlos Garnacho  <carlos@imendio.com>

	Bug 83935 – GtkEntry's default invisible char should be U+25CF

	* gtk/gtkentry.c (find_invisible_char) (gtk_entry_init): Find a
	more suitable invisible char than '*' based on the used font.
	(gtk_entry_class_init) (gtk_entry_set_property)
	(gtk_entry_get_property): Add a "invisible-char-set" property.
	(gtk_entry_unset_invisible_char): New function, needed now that the
	default invisible char isn't fixed.
	* gtk/gtkentry.h:
	* gtk/gtk.symbols:
	* docs/reference/gtk/gtk-sections.txt: Add the new function.

2008-09-19  Christian Persch  <chpe@gnome.org>
 
 	Bug 552837 – mem leak in gtkimmulticontext
 
 	* gtk/gtkimmulticontext.c: (gtk_im_multicontext_get_slave): Plug mem
 	leak.
 
2008-09-18  Emmanuele Bassi  <ebassi@linux.intel.com>

	* gtk/gtkfilechooserdefault.c (settings_save): Save the size column
	visibility state with the rest of the FileChooser settings.

2008-09-18  Emmanuele Bassi  <ebassi@linux.intel.com>

	Bug 325095 – show a 'size' column

	* gtk/gtkfilechooserdefault.c:
	* gtk/gtkfilechooserprivate.h: Add a context menu item controlling
	the visibility of the file size column. This works only for the
	browse mode, and the column is not visible by default.

	* gtk/gtkfilechoosersettings.[ch]: Add a ShowSizeColumn key to the
	settings file.

2008-09-18  Dominic Lachowicz  <domlachowicz@gmail.com>

	* modules/engines/ms-windows/*: Revert most of previous patch, as
	it didn't work as expected; Some work toward #531086 - the new
	GtkTooltip widget doesn't theme properly on win32. Now, at least
	the background color seems okay
	
2008-09-18  Dominic Lachowicz  <domlachowicz@gmail.com>

	* modules/engines/ms-windows/*: MS Windows style should use
	pango_win32_font_description_from_logfont; Allows us to rip out a
	lot of potentially buggy code, and also get the font specification
	from the XP theme (#434987)
	
2008-09-18  Matthias Clasen  <mclasen@redhat.com>

	* configure.in: updated version number to 2.15.0 for development.

	* ChangeLog.pre-2-14: rotate ChangeLog

=== Branch for 2.14 ===
